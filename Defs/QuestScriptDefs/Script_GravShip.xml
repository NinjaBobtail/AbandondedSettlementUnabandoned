<?xml version="1.0" encoding="utf-8" ?>
<Defs>
  
  <QuestScriptDef>
    <defName>MechanoidSignal</defName>
    <isRootSpecial>true</isRootSpecial>
    <questNameRules>
      <rulesStrings>
        <li>questName->mechanoid signal</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You've detected a signal from a mechanoid ship in orbit. The ship has malfunctioned and is slowly losing altitude.\n\nBy falsely responding to the signal you can make the ship crashland nearby, letting you salvage valuable grav tech.</li>
        
        <li>gravEngineSpawnedLetterLabel->grav engine</li>
        <li>gravEngineSpawnedLetterText->The mechanoid ship has crashlanded nearby.\n\nIt contains a working grav engine. The engine pushes against gravity and generates a lift field around itself, allowing it to levitate massive ships or platforms. While it does not work when far from a planet, it can be used to move across the planet and to reach orbit.\n\nInspect the engine to make use of it.</li>
      </rulesStrings>
    </questDescriptionRules>
    <root Class="QuestNode_Root_MechanoidSignal" />
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>GravEngine</defName>
    <isRootSpecial>true</isRootSpecial>
    <autoAccept>true</autoAccept>
    <defaultChallengeRating>4</defaultChallengeRating>
    <questNameRules>
      <rulesStrings>
        <li>questName->the gravship</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You've discovered a mechanoid grav engine! You can use this to build a gravship to quickly move around the planet.\n\nThe engine includes tech that passively scans for nearby gravship technology. If you obtain this gravship tech, you can upgrade your gravship over time.</li>
      </rulesStrings>
    </questDescriptionRules>
    <root Class="QuestNode_Root_GravShip">
      <subquestDefs>
        <li>Gravcore_MechanoidRelay</li>
        <li>Gravcore_InsectLair</li>
        <li>Gravcore_AncientReactor</li>
        <li>Gravcore_OrbitalMechanoidPlatform</li>
        <li>Gravcore_AncientStockpile</li>
        <li>Gravcore_CrashedMechanoidPlatform</li>
        <li>Gravcore_OrbitalAncientPlatform</li>
        <li>Gravcore_FrozenTerraformer</li>
        <li>Gravcore_Mechhive</li>
        <li>Gravcore_AbandonedSettlement</li>
      </subquestDefs>
    </root>
  </QuestScriptDef>
  
  <QuestScriptDef>
    <defName>Gravcore_MechanoidRelay</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->mechanoid relay</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected the energy signature of a gravcore. It is powering a relay that is part of a huge mechanoid communication net.\n\nYou can disassemble the relay, but the process will take days to complete. The relay itself will be heavily defended by mechanoids.\n\nObtain gravcores and gravlite panels to increase the size of your gravship.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questContentRules>
      <rulesStrings>
        <li>letterLabelMapGenerated->Mechanoid relay</li> 
        <li>letterTextMapGenerated->A mechanoid relay is nearby, powered by a gravcore.\n\nThe relay is currently protected by nearby stabilizers. Extract the relay's gravcore by first hacking or destroying all the stabilizers.\n\nBe careful, destroying a stabilizer will prompt a defensive response. Hacking is a slower but safer option.</li>
      </rulesStrings>
    </questContentRules>
    <questAvailableLetterLabel>Gravcore detected: Mechanoid relay</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_MechanoidRelay">
      <distanceFromColonyRange>10~60</distanceFromColonyRange>
      <selectLandmarkChance>1</selectLandmarkChance>
      <layer>Surface</layer>
      <allowedBiomes>
        <li>LavaField</li>
        <li>Glowforest</li>
        <li>GlacialPlain</li>
        <li>ExtremeDesert</li>
        <li>TropicalSwamp</li>
        <li>IceSheet</li>
      </allowedBiomes>
    </root>
  </QuestScriptDef>
  
  <QuestScriptDef>
    <defName>Gravcore_InsectLair</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->cave entrance</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected the energy signature of a gravcore. The signal emanates from a cave system deep underground. The entrance to the cave system is marked on the world map.\n\nSubterranean caves can be extremely dangerous and may take days to explore.\n\nObtain gravcores and gravlite panels to increase the size of your gravship.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questAvailableLetterLabel>Gravcore detected: Cave entrance</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_InsectLair">
      <distanceFromColonyRange>40~160</distanceFromColonyRange>
      <selectLandmarkChance>0</selectLandmarkChance>
      <requiredSubquestsGiven>3</requiredSubquestsGiven>
      <layer>Surface</layer>
      <minHilliness>Mountainous</minHilliness>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>Gravcore_AncientReactor</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->ancient reactor</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected the energy signature of a gravcore. The signal originates from an ancient decaying reactor. The location is marked on the world map.\n\nCracks in the reactor's shielding are leaking harmful material, bathing the nearby area in toxic fallout. The reactor itself will be heavily guarded by ancient security systems.\n\nObtain gravcores and gravlite panels to increase the size of your gravship.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questAvailableLetterLabel>Gravcore detected: Ancient reactor</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_AncientReactor">
      <selectLandmarkChance>0</selectLandmarkChance>
      <requiredSubquestsGiven>1</requiredSubquestsGiven>
      <layer>Surface</layer>
      <allowedBiomes>
        <li>Scarlands</li>
      </allowedBiomes>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>Gravcore_OrbitalMechanoidPlatform</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->Mechanoid platform</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected the energy signature of a gravcore. The signal is coming from an orbital mechanoid platform. Scans reveal a heavy defensive presence.\n\nYou can travel to orbital platforms using gravships, shuttles, or transport pods.\n\nBe careful, orbital locations are extremely dangerous. Equip your colonists with vacsuits. Plan your return trip, as living in orbit for long periods is very difficult.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questAvailableLetterLabel>Gravcore detected: Mechanoid platform</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_OrbitalMechanoidPlatform">
      <distanceFromColonyRange>2~8</distanceFromColonyRange> <!-- distance is in on the orbital layer tiles -->
      <selectLandmarkChance>0</selectLandmarkChance>
      <requiredSubquestsGiven>5</requiredSubquestsGiven>
      <layer>Orbit</layer>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>Gravcore_AncientStockpile</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->Ancient stockpile</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected the energy signature of a gravcore. The signal originates from an ancient underground stockpile. The location is marked on the world map.\n\nUnderground stockpiles must be hacked to enter. This process can take days to complete.\n\nObtain gravcores and gravlite panels to increase the size of your gravship.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questAvailableLetterLabel>Gravcore detected: Ancient stockpile</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_AncientStockpile">
      <distanceFromColonyRange>10~60</distanceFromColonyRange>
      <selectLandmarkChance>0</selectLandmarkChance>
      <layer>Surface</layer>
      <allowedBiomes>
        <li>Scarlands</li>
        <li>LavaField</li>
        <li>Glowforest</li>
        <li>GlacialPlain</li>
        <li>Grasslands</li>
        <li>Desert</li>
        <li>ExtremeDesert</li>
      </allowedBiomes>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>Gravcore_CrashedMechanoidPlatform</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->crashed mechanoid platform</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected the energy signature of a gravcore. The signal is coming from the wreckage of a crashed orbital platform.\n\nScans reveal a heavy mechanoid presence.\n\nObtain gravcores and gravlite panels to increase the size of your gravship.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questAvailableLetterLabel>Gravcore detected: Crash site</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_CrashedMechanoidPlatform">
      <distanceFromColonyRange>40~160</distanceFromColonyRange>
      <selectLandmarkChance>0</selectLandmarkChance>
      <requiredSubquestsGiven>2</requiredSubquestsGiven>
      <layer>Surface</layer>
      <allowedBiomes>
        <li>Grasslands</li>
        <li>TropicalSwamp</li>
        <li>Glowforest</li>
        <li>ColdBog</li>
        <li>LavaField</li>
        <li>GlacialPlain</li>
        <li>Scarlands</li>
        <li>Desert</li>
        <li>ExtremeDesert</li>
      </allowedBiomes>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>Gravcore_OrbitalAncientPlatform</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->abandoned orbital platform</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected the energy signature of a gravcore. The signal is coming from an abandoned orbital platform.\n\nYou can travel to orbital platforms using gravships, shuttles, or transport pods.\n\nBe careful, orbital locations are extremely dangerous. Equip your colonists with vacsuits. Plan your return trip, as living in orbit for long periods is very difficult.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questAvailableLetterLabel>Gravcore detected: Orbital platform</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_OrbitalAncientPlatform">
      <distanceFromColonyRange>2~8</distanceFromColonyRange> <!-- distance is in on the orbital layer tiles -->
      <selectLandmarkChance>0</selectLandmarkChance>
      <requiredSubquestsGiven>3</requiredSubquestsGiven>
      <layer>Orbit</layer>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>Gravcore_FrozenTerraformer</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->frozen terraformer</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected the energy signature of a gravcore. The gravcore is powering a malfunctioning ancient terraformer. Its location is marked on the world map.\n\nThe terraformer is cooling the local region to dangerously low temperatures. Be prepared for cold weather and a long stay.\n\nObtain gravcores and gravlite panels to increase the size of your gravship.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questAvailableLetterLabel>Gravcore detected: Frozen terraformer</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_FrozenTerraformer">
      <distanceFromColonyRange>40~160</distanceFromColonyRange>
      <selectLandmarkChance>0</selectLandmarkChance>
      <requiredSubquestsGiven>1</requiredSubquestsGiven>
      <layer>Surface</layer>
      <allowedBiomes>
        <li>GlacialPlain</li>
        <li>IceSheet</li>
        <li>Tundra</li>
      </allowedBiomes>
      <maxHilliness>SmallHills</maxHilliness>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>Gravcore_Mechhive</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->mechhive</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->You have detected a huge gravtech energy spike originating from a mechhive in orbit. Its location is marked on the world map.\n\nThis mechhive is the center of mechanoid intelligence on this planet. Shutting it down will disable all murderous mechanoids planet-wide. Alternatively, you may be able to use the mechhive for your own purposes.\n\nThe mechhive is defended with anti-ship weapons. Build a signal jammer before approaching it.\n\nBe warned, mechhives are extremely dangerous. Finish exploring other locations first and ensure you're prepared for a long stay in orbit.</li>
      </rulesStrings>
    </questDescriptionRules>
    <questAvailableLetterLabel>Mechhive detected</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_Mechhive">
      <distanceFromColonyRange>3~15</distanceFromColonyRange> <!-- distance is in on the orbital layer tiles -->
      <selectLandmarkChance>0</selectLandmarkChance>
      <requiredSubquestsGiven>7</requiredSubquestsGiven> <!-- 7 so that players can still get the mechhive if the insect faction is disabled (preventing the megahive gravcore location) -->
      <layer>Orbit</layer>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>GravshipWreckage</defName>
    <rootSelectionWeight>2</rootSelectionWeight>
    <minRefireDays>120</minRefireDays> <!-- 2 years -->
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->Gravship wreckage</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <!-- Asker is null -->
        <li>questDescription(askerIsNull==true)->You've intercepted the distress beacon from a crashed gravship. The wreckage contains valuable gravtech. Be careful - it is guarded by hostile mechanoids.</li>

        <!-- Leader asker -->
        <li>questDescription(asker_factionLeader==true)->[asker_faction_leaderTitle] [asker_nameFull] of [asker_faction_name] has shared with you the location of a crashed gravship. [asker_pronoun] heard of your study of gravcore technology and thought you might be interested in scavenging whatever gravtech remains. [asker_nameDef] warns you that the crash site is guarded by hostile mechanoids.</li>

        <!-- Royal asker -->
        <li>questDescription(asker_royalInCurrentFaction==true)->[asker_nameFull], a [asker_royalTitleInCurrentFaction] of [asker_faction_name], demands that you destroy a number of bothersome mechanoids that are harassing a nearby settlement. The mechanoids are guarding the wreckage of a gravship. If you destroy the mechanoids, [asker_nameDef] will let you keep whatever gravtech you're able to scavenge.</li>
      </rulesStrings>
    </questDescriptionRules>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravship_Wreckage">
      <distanceFromColonyRange>5~20</distanceFromColonyRange>
      <selectLandmarkChance>1</selectLandmarkChance>
      <requiresLandmark>true</requiresLandmark>
      <layer>Surface</layer>
    </root>
  </QuestScriptDef>

  <QuestScriptDef>
    <defName>Gravcore_AbandonedSettlement</defName>
    <autoAccept>true</autoAccept>
    <questNameRules>
      <rulesStrings>
        <li>questName->abandonded settlement</li>
      </rulesStrings>
    </questNameRules>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription->Testing</li>
      </rulesStrings>
    </questDescriptionRules>
    <questContentRules>
      <rulesStrings>
        <li>letterLabelMapGenerated->Abandonded Settlement</li> 
        <li>letterTextMapGenerated->testing</li>
      </rulesStrings>
    </questContentRules>
    <questAvailableLetterLabel>Gravcore detected: Abandonded Settlement</questAvailableLetterLabel>
    <questAvailableLetterTextIsDescription>true</questAvailableLetterTextIsDescription>
    <canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
    <root Class="QuestNode_Root_Gravcore_AbandonedSettlement">
      <distanceFromColonyRange>10~60</distanceFromColonyRange>
      <selectLandmarkChance>1</selectLandmarkChance>
      <layer>Surface</layer>
      <allowedBiomes>
        <li>LavaField</li>
        <li>Glowforest</li>
        <li>GlacialPlain</li>
        <li>ExtremeDesert</li>
        <li>TropicalSwamp</li>
        <li>IceSheet</li>
      </allowedBiomes>
    </root>
  </QuestScriptDef>

</Defs>